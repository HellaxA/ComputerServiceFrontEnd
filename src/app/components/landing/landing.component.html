<div class="container-fluid">
  <!-- gpu search -->
  <div class="pc-container">
    <form [formGroup]="pcCompatibilityForm" class="form-border" (ngSubmit)="onSubmit($event)">
      <div class="text-center" *ngIf="gpusResponse">
        <span class="text-danger" *ngFor="let gpuResponse of gpusResponse"> <br>{{ gpuResponse }}</span>
      </div>
      <div class="form-select-body">
        <ng-select [items]="gpus"
                   bindLabel="name"
                   [loading]="gpuLoading"
                   [minTermLength]="1"
                   [typeahead]="gpuSearchTerm$"
                   [multiple]="true"
                   maxSelectedItems="2"
                   [compareWith]="compareGpus"
                   placeholder="Gpu search..."
                   formControlName="gpus"
                   (change)="resetAllWithFixButton()">
        </ng-select>
      </div>
      <!-- motherboard search -->

      <div class="form-select-body">
        <div *ngIf="motherboardForm.invalid && (motherboardForm.dirty || motherboardForm.touched)">
          <div *ngIf="motherboardForm.errors.required" class="text-center">
            <span class="text-danger">Motherboard is required</span>
          </div>
        </div>
        <div class="text-center">
          <span class="text-danger"></span>
        </div>
        <ng-select [items]="motherboards"
                   bindLabel="name"
                   [loading]="motherboardLoading"
                   [minTermLength]="1"
                   [typeahead]="motherboardTerm$"
                   placeholder="Motherboard search..."
                   formControlName="motherboard"
                   (change)="resetAllWithFixButton()">
        </ng-select>
      </div>

      <!-- ram search -->

      <div class="form-select-body">
        <div class="text-center">
          <span class="text-danger" *ngIf="ramAmountCompatibleWithMotherboard"> {{ ramAmountCompatibleWithMotherboard }}
            <br></span>
          <span class="text-danger" *ngIf="ramTypeCompatibleWithMotherboard"> {{ ramTypeCompatibleWithMotherboard }}<br></span>
          <span class="text-danger"
                *ngIf="ramGbAmountCompatibleWithMotherboard"> {{ ramGbAmountCompatibleWithMotherboard }}<br></span>
        </div>
        <div *ngIf="ramForm.invalid && (ramForm.dirty || ramForm.touched)">
          <div *ngIf="ramForm.errors.required" class="text-center">
            <span class="text-danger">Ram is required</span>
          </div>
        </div>
        <ng-select [items]="rams"
                   bindLabel="name"
                   [loading]="ramLoading"
                   [minTermLength]="1"
                   [typeahead]="ramSearchTerm$"
                   placeholder="RAM search..."
                   formControlName="ram"
                   (change)="resetAllWithFixButton()">
        </ng-select>
        <div *ngIf="fixResponse?.pcCompatibilityCheckResponseDto.ramAmountCompatibleWithMotherboard ||
                    fixResponse?.pcCompatibilityCheckResponseDto.ramGbAmountCompatibleWithMotherboard ||
                    fixResponse?.pcCompatibilityCheckResponseDto.ramTypeCompatibleWithMotherboard">
          <div *ngIf="fixResponse.rams?.length > 0">
            <span>We have found few RAM's that you could pick so that your PC assembly will work!</span>
            <div *ngFor="let ram of fixResponse.rams">
              Name: {{ram.name}} |
              Price: {{ram.price | currency: 'USD' }}
            </div>
          </div>
        </div>
      </div>

      <!-- power supply search -->
      <div class="form-select-body">
        <div class="text-center">
          <span class="text-danger" *ngIf="tdpValid"> {{ tdpValid }}<br></span>
          <span class="text-danger"
                *ngIf="powerSupplyCompatibleWithMotherboardCpuPower"> {{ powerSupplyCompatibleWithMotherboardCpuPower }}
            <br></span>
          <span class="text-danger"
                *ngIf="powerSupplyCompatibleWithMotherboardPower"> {{ powerSupplyCompatibleWithMotherboardPower }}
            <br></span>
        </div>
        <div *ngIf="powerSupplyForm.invalid && (powerSupplyForm.dirty || powerSupplyForm.touched)">
          <div *ngIf="powerSupplyForm.errors.required" class="text-center">
            <span class="text-danger">Power Supply is required</span>
          </div>
        </div>
        <ng-select [items]="powerSupplies"
                   bindLabel="name"
                   [loading]="powerSupplyLoading"
                   [minTermLength]="1"
                   [typeahead]="powerSupplyTerm$"
                   placeholder="Power supply search..."
                   formControlName="powerSupply"
                   (change)="resetAllWithFixButton()">
        </ng-select>
        <div *ngIf="fixResponse?.pcCompatibilityCheckResponseDto.powerSupplyCompatibilityWithGpuPower ||
                    fixResponse?.pcCompatibilityCheckResponseDto.powerSupplyCompatibleWithMotherboardCpuPower ||
                    fixResponse?.pcCompatibilityCheckResponseDto.powerSupplyCompatibleWithMotherboardPower ||
                    fixResponse?.pcCompatibilityCheckResponseDto.tdpValid">

          <div *ngIf="fixResponse.powerSupplies?.length > 0">
            <span>We have found few power supplies that you could pick so that your PC assembly will work!</span>
            <div *ngFor="let powerSupply of fixResponse.powerSupplies">
              Name: {{powerSupply.name}} |
              Price: {{powerSupply.price | currency: 'USD' }}
            </div>
          </div>
        </div>
      </div>

      <!-- processor search -->

      <div class="form-select-body">
        <div class="text-center">
          <span class="text-danger"
                *ngIf="processorCompatibleWithMotherboardSocket"> {{ processorCompatibleWithMotherboardSocket }}
            <br></span>
        </div>
        <div *ngIf="cpuForm.invalid && (cpuForm.dirty || cpuForm.touched)">
          <div *ngIf="cpuForm.errors.required" class="text-center">
            <span class="text-danger">CPU is required</span>
          </div>
        </div>
        <ng-select [items]="cpus"
                   bindLabel="name"
                   [loading]="cpuLoading"
                   [minTermLength]="1"
                   [typeahead]="cpuSearchTerm$"
                   placeholder="Processor search..."
                   formControlName="processor"
                   (change)="resetAllWithFixButton()">
        </ng-select>
        <div *ngIf="fixResponse?.pcCompatibilityCheckResponseDto.processorCompatibleWithMotherboardSocket">

          <div *ngIf="fixResponse.processors?.length > 0">
            <span>We have found few processors that you could pick so that your PC assembly will work!</span>
            <div *ngFor="let proc of fixResponse.processors">
              Name: {{proc.name}} |
              Price: {{proc.price | currency: 'USD' }}
            </div>
          </div>
        </div>
      </div>


      <div *ngIf="isCompatible" class="text-center ">
        <span class="text-success">This pc will work!</span>
      </div>
      <div class="form-select-button text-center">
        <button type="submit" class="btn btn-dark" [disabled]="!pcCompatibilityForm.valid ||
         checkCompatibilityLoading" id="check_compatibility_button">
          Check compatibility
          <span *ngIf="checkCompatibilityLoading" class="spinner-border spinner-border-sm"></span>
        </button>
        <button type="submit" class="btn btn-dark ml-2" id="propose_button">
          Propose Components
          <span *ngIf="false" class="spinner-border spinner-border-sm"></span>
        </button>
        <button *ngIf="isCompatible === false" type="submit" class="btn btn-dark ml-2"
                [disabled]=fixLoading id="fix_button">
          Fix
          <span *ngIf="fixLoading" class="spinner-border spinner-border-sm"></span>
        </button>
      </div>
    </form>
  </div>
</div>
